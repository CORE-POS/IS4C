<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>CORE POS - IS4C: PrehLib Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
</script>
<link rel="search" href="search-opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="CORE POS - IS4C"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CORE POS - IS4C
   </div>
   <div id="projectbrief">The CORE POS front end</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.php" method="get">
              <img id="MSearchSelect" src="search/mag.png" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="class_preh_lib-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">PrehLib Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for PrehLib:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_preh_lib.png" usemap="#PrehLib_map" alt=""/>
  <map id="PrehLib_map" name="PrehLib_map">
<area href="class_library_class.html" alt="LibraryClass" shape="rect" coords="0,0,84,24"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a21622b617a4ceefe9fff510aa0031e73"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preh_lib.html#a21622b617a4ceefe9fff510aa0031e73">clearMember</a> ()</td></tr>
<tr class="separator:a21622b617a4ceefe9fff510aa0031e73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a250152d649b618ba52c2dc0b1e532e6c"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preh_lib.html#a250152d649b618ba52c2dc0b1e532e6c">memberID</a> ($member_number)</td></tr>
<tr class="separator:a250152d649b618ba52c2dc0b1e532e6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b9e7cc22a95e1278a7855af9344595d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1b9e7cc22a95e1278a7855af9344595d"></a>
static&#160;</td><td class="memItemRight" valign="bottom"><b>requestInfoCallback</b> ($info)</td></tr>
<tr class="separator:a1b9e7cc22a95e1278a7855af9344595d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ef4fc77208466cb48558a4d8081eca7"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preh_lib.html#a2ef4fc77208466cb48558a4d8081eca7">setAltMemMsg</a> ($store, $member, $personNumber, $row, $<a class="el" href="class_preh_lib.html#ac7b49f669743a34195e4c132d3e33a70">chargeOk</a>)</td></tr>
<tr class="separator:a2ef4fc77208466cb48558a4d8081eca7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8d3b4a8f7ba5b14ac8d96cc382e673f"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preh_lib.html#ac8d3b4a8f7ba5b14ac8d96cc382e673f">setMember</a> ($member, $personNumber, $row=array())</td></tr>
<tr class="separator:ac8d3b4a8f7ba5b14ac8d96cc382e673f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a467f33f366e690132836e19b0e9546fd"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preh_lib.html#a467f33f366e690132836e19b0e9546fd">checkUnpaidAR</a> ($cardno)</td></tr>
<tr class="separator:a467f33f366e690132836e19b0e9546fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa50e492c46b2695acd664db39a745130"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa50e492c46b2695acd664db39a745130"></a>
static&#160;</td><td class="memItemRight" valign="bottom"><b>check_unpaid_ar</b> ($cardno)</td></tr>
<tr class="separator:aa50e492c46b2695acd664db39a745130"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0364d8f19d34eba20a685721d780ce55"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preh_lib.html#a0364d8f19d34eba20a685721d780ce55">checkstatus</a> ($num)</td></tr>
<tr class="separator:a0364d8f19d34eba20a685721d780ce55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a968e1bd2be552183b77c1f79323330f2"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preh_lib.html#a968e1bd2be552183b77c1f79323330f2">tender</a> ($right, $strl)</td></tr>
<tr class="separator:a968e1bd2be552183b77c1f79323330f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c26d662e64f0e1717a8c96356124d0a"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preh_lib.html#a7c26d662e64f0e1717a8c96356124d0a">deptkey</a> ($price, $dept, $ret=array())</td></tr>
<tr class="separator:a7c26d662e64f0e1717a8c96356124d0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9b1934491a95a26dcb42f0a66e4f919"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preh_lib.html#af9b1934491a95a26dcb42f0a66e4f919">ttl</a> ()</td></tr>
<tr class="separator:af9b1934491a95a26dcb42f0a66e4f919"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a567cd27adb4979abc8e74f45f9be2f14"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preh_lib.html#a567cd27adb4979abc8e74f45f9be2f14">omtr_ttl</a> ()</td></tr>
<tr class="separator:a567cd27adb4979abc8e74f45f9be2f14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfedde08ba4427337b5722b5c6fbbc09"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preh_lib.html#acfedde08ba4427337b5722b5c6fbbc09">wicableTotal</a> ()</td></tr>
<tr class="separator:acfedde08ba4427337b5722b5c6fbbc09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae599664e2b7042bbb108846bac16b2db"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preh_lib.html#ae599664e2b7042bbb108846bac16b2db">peekItem</a> ($full_record=false)</td></tr>
<tr class="separator:ae599664e2b7042bbb108846bac16b2db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89a499378c8bdb90e8f334424b5ffa74"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preh_lib.html#a89a499378c8bdb90e8f334424b5ffa74">finalttl</a> ()</td></tr>
<tr class="separator:a89a499378c8bdb90e8f334424b5ffa74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a385cfa1d833817523a55d8ec8ca48192"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preh_lib.html#a385cfa1d833817523a55d8ec8ca48192">fsEligible</a> ()</td></tr>
<tr class="separator:a385cfa1d833817523a55d8ec8ca48192"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e6d503cd0df830c2603f089e06ec3f6"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preh_lib.html#a1e6d503cd0df830c2603f089e06ec3f6">percentDiscount</a> ($strl, $json=array())</td></tr>
<tr class="separator:a1e6d503cd0df830c2603f089e06ec3f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7b49f669743a34195e4c132d3e33a70"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preh_lib.html#ac7b49f669743a34195e4c132d3e33a70">chargeOk</a> ()</td></tr>
<tr class="separator:ac7b49f669743a34195e4c132d3e33a70"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a2646d1f9afa89b2bc12c425f0169d775"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2646d1f9afa89b2bc12c425f0169d775"></a>
static&#160;</td><td class="memItemRight" valign="bottom"><b>$requestInfoHeader</b> = 'member gift'</td></tr>
<tr class="separator:a2646d1f9afa89b2bc12c425f0169d775"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac582998af27ab7014345059a341c1184"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac582998af27ab7014345059a341c1184"></a>
static&#160;</td><td class="memItemRight" valign="bottom"><b>$requestInfoMsg</b> = 'Card for which member?'</td></tr>
<tr class="separator:ac582998af27ab7014345059a341c1184"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A horrible, horrible catch-all clutter of functions </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ac7b49f669743a34195e4c132d3e33a70"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static PrehLib::chargeOk </td>
          <td>(</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check whether the current member has store charge balance available. </p>
<dl class="section return"><dt>Returns</dt><dd>1 - Yes 0 - No</dd></dl>
<p>Sets current balance in session as "balance". Sets available balance in session as "availBal". </p>

</div>
</div>
<a class="anchor" id="a0364d8f19d34eba20a685721d780ce55"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static PrehLib::checkstatus </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$num</em>)</td><td></td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check if an item is voided or a refund </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$num</td><td>item trans_id in localtemptrans </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array of status information with keys:<ul>
<li>voided (int)</li>
<li>scaleprice (numeric)</li>
<li>discountable (int)</li>
<li>discounttype (int)</li>
<li>caseprice (numeric)</li>
<li>refund (boolean)</li>
<li>status (string) </li>
</ul>
</dd></dl>

</div>
</div>
<a class="anchor" id="a467f33f366e690132836e19b0e9546fd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static PrehLib::checkUnpaidAR </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$cardno</em>)</td><td></td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check if the member has overdue store charge balance </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$cardno</td><td>member number </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True or False</dd></dl>
<p>The logic for what constitutes past due has to be built into the unpaid_ar_today view. Without that this function doesn't really do much. </p>

</div>
</div>
<a class="anchor" id="a21622b617a4ceefe9fff510aa0031e73"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static PrehLib::clearMember </td>
          <td>(</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Remove member number from current transaction </p>

</div>
</div>
<a class="anchor" id="a7c26d662e64f0e1717a8c96356124d0a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static PrehLib::deptkey </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$price</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$dept</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$ret</em> = <code>array()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Add an open ring to a department </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$price</td><td>amount in cents (100 = $1) </td></tr>
    <tr><td class="paramname">$dept</td><td>POS department  an array of return values </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An array. See <a class="el" href="class_parser.html#a0076d421db25e8eb844d0ecc093688ad">Parser::default_json()</a> for format explanation. </dd></dl>
<p>Enforce memberOnly flag</p>

</div>
</div>
<a class="anchor" id="a89a499378c8bdb90e8f334424b5ffa74"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static PrehLib::finalttl </td>
          <td>(</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Add tax and transaction discount records. This is called at the end of a transaction. There's probably no other place where calling this function is appropriate. </p>

</div>
</div>
<a class="anchor" id="a385cfa1d833817523a55d8ec8ca48192"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static PrehLib::fsEligible </td>
          <td>(</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Add foodstamp elgibile total record </p>

</div>
</div>
<a class="anchor" id="a250152d649b618ba52c2dc0b1e532e6c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static PrehLib::memberID </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$member_number</em>)</td><td></td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Begin setting a member number for a transaction </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$member_number</td><td>CardNo from custdata </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An array. See <a class="el" href="class_parser.html#a0076d421db25e8eb844d0ecc093688ad">Parser::default_json()</a> for format.</dd></dl>
<p>This function will either assign the number to the current transaction or return a redirect request to get more input. If you want the cashier to verify member name from a list, use this function. If you want to force the number to be set immediately, use <a class="el" href="class_preh_lib.html#ac8d3b4a8f7ba5b14ac8d96cc382e673f">setMember()</a>. </p>
<p>If only a single record exists for the member number, the member will be set immediately if:</p>
<ul>
<li>the account is the designated, catchall non-member</li>
<li>the verifyName setting is disabled</li>
</ul>
<p>Go to member search page in all other cases. If zero matching records are found, member search should be next. If multiple records are found, picking the correct name should be next. If verifyName is enabled, confirming the name should be next.</p>

</div>
</div>
<a class="anchor" id="a567cd27adb4979abc8e74f45f9be2f14"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static PrehLib::omtr_ttl </td>
          <td>(</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Total the transaction, which the cashier thinks may be eligible for the Ontario Meal Tax Rebate. </p>
<dl class="section return"><dt>Returns</dt><dd>True - total successfully String - URL</dd></dl>
<p>If <a class="el" href="class_preh_lib.html#af9b1934491a95a26dcb42f0a66e4f919">ttl()</a> returns a string, go to that URL for more information on the error or to resolve the problem.</p>
<p>The most common error, by far, is no member number in which case the return value is the member-entry page.</p>
<p>The Ontario Meal Tax Rebate refunds the provincial part of the Harmonized Sales Tax if the total of the transaction is not more than a certain amount.</p>
<p>If the transaction qualifies, change the tax status for each item at the higher rate to the lower rate. Display a message that a change was made. Otherwise display a message about that. Total the transaction as usual. </p>

</div>
</div>
<a class="anchor" id="ae599664e2b7042bbb108846bac16b2db"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static PrehLib::peekItem </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$full_record</em> = <code>false</code>)</td><td></td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>See what the last item in the transaction is currently </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$full_record</td><td>[boolean] return full database record. Default is false. Just returns description. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>localtemptrans.description for the last item or localtemptrans record for the last item</dd></dl>
<p>If no record exists, returns false </p>

</div>
</div>
<a class="anchor" id="a1e6d503cd0df830c2603f089e06ec3f6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static PrehLib::percentDiscount </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$strl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$json</em> = <code>array()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Add a percent discount notification </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$strl</td><td>discount percentage </td></tr>
    <tr><td class="paramname">$json</td><td>keyed array </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An array see <a class="el" href="class_parser.html#a0076d421db25e8eb844d0ecc093688ad">Parser::default_json()</a> </dd></dl>
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000006">Deprecated:</a></b></dt><dd>Use discountnotify() instead. This just adds hard-coded percentages and PLUs that likely aren't applicable anywhere but the Wedge. </dd></dl>

</div>
</div>
<a class="anchor" id="a2ef4fc77208466cb48558a4d8081eca7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static PrehLib::setAltMemMsg </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$store</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$member</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$personNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$chargeOk</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Assign store-specific alternate member message line </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$store</td><td>code for the coop </td></tr>
    <tr><td class="paramname">$member</td><td>CardNo from custdata </td></tr>
    <tr><td class="paramname">$personNumber</td><td>personNum from custdata </td></tr>
    <tr><td class="paramname">$row</td><td>a record from custdata </td></tr>
    <tr><td class="paramname">$chargeOk</td><td>whether member can store-charge purchases </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ac8d3b4a8f7ba5b14ac8d96cc382e673f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static PrehLib::setMember </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$member</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$personNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$row</em> = <code>array()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Assign a member number to a transaction </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$member</td><td>CardNo from custdata </td></tr>
    <tr><td class="paramname">$personNumber</td><td>personNum from custdata</td></tr>
  </table>
  </dd>
</dl>
<p>See <a class="el" href="class_preh_lib.html#a250152d649b618ba52c2dc0b1e532e6c">memberID()</a> for more information. </p>
<p>Look up the member information here. There's no good reason to have calling code pass in a specially formatted row of data</p>
<p>Optinonally use memtype table to normalize attributes by member type</p>
<p>Determine what string is shown in the upper left of the screen to indicate the current member</p>
<p>Set member number and attributes in the current transaction</p>
<p>Add the member discount</p>
<p>Log the member entry</p>
<p>Optionally add a subtotal line depending on member_subtotal setting.</p>

</div>
</div>
<a class="anchor" id="a968e1bd2be552183b77c1f79323330f2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static PrehLib::tender </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$right</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$strl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Add a tender to the transaction</p>
<p>tender amount in cents (100 = $1)  tender code from tenders table </p>
<dl class="section return"><dt>Returns</dt><dd>An array see <a class="el" href="class_parser.html#a0076d421db25e8eb844d0ecc093688ad">Parser::default_json()</a> for format explanation.</dd></dl>
<p>This function will automatically end a transaction if the amount due becomes &lt;= zero. </p>
<p>First use base module to check for error conditions common to all tenders</p>
<p>Get a tender-specific module if one has been configured</p>
<p>Fetch module mapping from the database if the schema supports it 16Mar2015</p>
<p>Do tender-specific error checking and prereqs</p>

</div>
</div>
<a class="anchor" id="af9b1934491a95a26dcb42f0a66e4f919"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static PrehLib::ttl </td>
          <td>(</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Total the transaction </p>
<dl class="section return"><dt>Returns</dt><dd>True - total successfully String - URL</dd></dl>
<p>If <a class="el" href="class_preh_lib.html#af9b1934491a95a26dcb42f0a66e4f919">ttl()</a> returns a string, go to that URL for more information on the error or to resolve the problem.</p>
<p>The most common error, by far, is no member number in which case the return value is the member-entry page. </p>

</div>
</div>
<a class="anchor" id="acfedde08ba4427337b5722b5c6fbbc09"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static PrehLib::wicableTotal </td>
          <td>(</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculate WIC eligible total </p>
<dl class="section return"><dt>Returns</dt><dd>[number] WIC eligible items total </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>pos/is4c-nf/lib/PrehLib.php</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Apr 2 2015 12:27:47 for CORE POS - IS4C by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.4
</small></address>
</body>
</html>
